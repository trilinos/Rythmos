#
# FRAMEWORK group
#

# This is how to test with SERIAL and MPI
# 09/01/05 tscoffe:  MPI runs are not ready yet.
#(FRAMEWORK,INSTALL) {
#    TESTS = ../example/basicExample/basicExample.exe;
#    COMM = SERIAL, MPI;
#}

# Default run, Explicit Runge-Kutta 4 stage
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample.exe;
    ARGS = --verbose --echo-command-line;
    COMM = SERIAL;
}

# Scalar Forward Euler
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample.exe;
    ARGS = --method=FE --maxerror=1e-1 --verbose --echo-command-line;
    COMM = SERIAL;
}

# Scalar Backward Euler
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample_amesos.exe;
    ARGS = --method=BE --maxerror=1e-1 --verbose --echo-command-line;
    COMM = SERIAL;
}

# Scalar ImplicitBDF with forcing term
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample_amesos.exe;
    ARGS = --method=BDF --numelements=1 --x0=1 --lambda_fit=linear --lambda_min=-0.3 --lambda_max=-0.3 --stepmethod=variable --T=1 --force_coeff=31.4159 --maxorder=1 --reltol=1e-6 --abstol=1e-6 --maxerror=1e-3  --verbose --echo-command-line;
    COMM = SERIAL;
}

# Vector Explicit Runge-Kutta 4 stage
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample.exe;
    ARGS = --numelements=10 --verbose --echo-command-line;
    COMM = SERIAL;
}

# Vector Forward Euler
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample.exe;
    ARGS = --method=FE --maxerror=1e-1 --numelements=10 --verbose --echo-command-line;
    COMM = SERIAL;
}

# Vector Backward Euler
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample_amesos.exe;
    ARGS = --method=BE --maxerror=1e-1 --numelements=10 --verbose --echo-command-line;
    COMM = SERIAL;
}

# Scalar Backward Euler using Amesos
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample_amesos.exe;
    ARGS = --method=BE --maxerror=1e-1 --numelements=1 --verbose --extra-linear-solver-params="<ParameterList><Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Amesos\"/></ParameterList>" --linear-solver-params-used-file=lowsf.amesos.used.xml --echo-command-line;
    COMM = SERIAL;
}

# Scalar Backward Euler using AztecOO
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample_aztecoo.exe;
    ARGS = --method=BE --maxerror=1e-1 --numelements=1 --verbose --extra-linear-solver-params="<ParameterList><Parameter name=\"Linear Solver Type\" type=\"string\" value=\"AztecOO\"/><ParameterList name =\"Linear Solver Types\"><ParameterList name=\"AztecOO\"><ParameterList name=\"Forward Solve\"><Parameter name=\"Tolerance\" type=\"double\" value=\"1e-12\"/></ParameterList></ParameterList></ParameterList></ParameterList>" --linear-solver-params-used-file=lowsf.aztecoo.used.xml --echo-command-line;
    COMM = SERIAL;
}

# Vector Backward Euler using Amesos
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample_amesos.exe;
    ARGS = --method=BE --maxerror=1e-1 --numelements=10 --verbose --extra-linear-solver-params="<ParameterList><Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Amesos\"/></ParameterList>" --linear-solver-params-used-file=lowsf.amesos.used.xml --echo-command-line;
    COMM = SERIAL;
}

# Vector Backward Euler using AztecOO
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample_aztecoo.exe;
    ARGS = --method=BE --maxerror=1e-1 --numelements=100 --verbose --extra-linear-solver-params="<ParameterList><Parameter name=\"Linear Solver Type\" type=\"string\" value=\"AztecOO\"/><ParameterList name =\"Linear Solver Types\"><ParameterList name=\"AztecOO\"><ParameterList name=\"Forward Solve\"><Parameter name=\"Tolerance\" type=\"double\" value=\"1e-12\"/></ParameterList></ParameterList></ParameterList></ParameterList>" --linear-solver-params-used-file=lowsf.aztecoo.used.xml --echo-command-line;
    COMM = SERIAL,MPI;
}

# Vector Backward Euler using Belos
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample_belos.exe;
    ARGS = --method=BE --maxerror=1e-1 --numelements=100 --verbose --extra-linear-solver-params="<ParameterList><Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Belos\"/><ParameterList name=\"Linear Solver Types\"><ParameterList name=\"Belos\"><Parameter name=\"Default Rel Res Norm\" type=\"double\" value=\"1e-12\"/></ParameterList></ParameterList></ParameterList>" --linear-solver-params-used-file=lowsf.belos.used.xml;
    COMM = SERIAL,MPI;
}

# Vector Forward Euler with same accuracy as ERK
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample.exe;
    ARGS = --numelements=100 --method=FE --T=0.1 --numsteps=5000 --verbose --echo-command-line;
    COMM = SERIAL,MPI;
}

# Vector Backward Euler with same accuracy as ERK
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample_amesos.exe;
    ARGS = --numelements=10 --method=BE --T=0.1 --numsteps=5000 --verbose --echo-command-line;
    COMM = SERIAL;
}

# Vector Implicit BDF
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample_amesos.exe;
    ARGS = --numelements=10 --method=BDF --stepmethod=variable --reltol=1e-6 --abstol=1e-6 --T=0.1 --maxerror=1e-4 --verbose --echo-command-line;
    COMM = SERIAL;
}

# Vector Backward Euler
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample_amesos.exe;
    ARGS = --method=BDF --maxorder=1 --maxerror=1e-1 --numelements=10 --verbose --echo-command-line;
    COMM = SERIAL;
}

# Vector Implicit BDF with AztecOO
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample_aztecoo.exe;
    ARGS = --numelements=100 --method=BDF --stepmethod=variable --reltol=1e-6 --abstol=1e-6 --T=0.1 --maxerror=1e-4 --verbose --extra-linear-solver-params="<ParameterList><Parameter name=\"Linear Solver Type\" type=\"string\" value=\"AztecOO\"/><ParameterList name =\"Linear Solver Types\"><ParameterList name=\"AztecOO\"><ParameterList name=\"Forward Solve\"><Parameter name=\"Tolerance\" type=\"double\" value=\"1e-12\"/></ParameterList></ParameterList></ParameterList></ParameterList>" --linear-solver-params-used-file=lowsf.aztecoo.used.xml --echo-command-line;
    COMM = SERIAL,MPI;
}

# Vector Implicit BDF with Belos
(FRAMEWORK,INSTALL) {
    TESTS = ../example/basicExample/basicExample_belos.exe;
    ARGS = --numelements=100 --method=BDF --stepmethod=variable --reltol=1e-6 --abstol=1e-6 --T=0.1 --maxerror=1e-4 --verbose --extra-linear-solver-params="<ParameterList><Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Belos\"/><ParameterList name=\"Linear Solver Types\"><ParameterList name=\"Belos\"><Parameter name=\"Default Rel Res Norm\" type=\"double\" value=\"1e-12\"/></ParameterList></ParameterList></ParameterList>" --linear-solver-params-used-file=lowsf.belos.used.xml;
    COMM = SERIAL,MPI;
}

# Vector 1DfemTransient with Backward Euler 
(FRAMEWORK,INSTALL) {
    TESTS = ../example/epetra/1Dfem/1DfemTransient_amesos.exe;
    ARGS = --verbose --echo-command-line;
    COMM = SERIAL;
}

# Vector 1DfemTransient with Backward Euler using AztecOO
(FRAMEWORK,INSTALL) {
    TESTS = ../example/epetra/1Dfem/1DfemTransient_aztecoo.exe;
    ARGS = --verbose --extra-linear-solver-params="<ParameterList><Parameter name=\"Linear Solver Type\" type=\"string\" value=\"AztecOO\"/><ParameterList name =\"Linear Solver Types\"><ParameterList name=\"AztecOO\"><ParameterList name=\"Forward Solve\"><Parameter name=\"Tolerance\" type=\"double\" value=\"1e-12\"/></ParameterList></ParameterList></ParameterList></ParameterList>" --linear-solver-params-used-file=lowsf.aztecoo.used.xml --echo-command-line;
    COMM = SERIAL,MPI;
}

# Vector 1DfemTransient with Backward Euler using Belos
(FRAMEWORK,INSTALL) {
    TESTS = ../example/epetra/1Dfem/1DfemTransient_belos.exe;
    ARGS = --verbose --extra-linear-solver-params="<ParameterList><Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Belos\"/><ParameterList name=\"Linear Solver Types\"><ParameterList name=\"Belos\"><Parameter name=\"Default Rel Res Norm\" type=\"double\" value=\"1e-12\"/></ParameterList></ParameterList></ParameterList>" --linear-solver-params-used-file=lowsf.belos.used.xml;
    COMM = SERIAL,MPI;
}

# Vector 1DfemTransient with ImplicitBDF
(FRAMEWORK,INSTALL) {
    TESTS = ../example/epetra/1Dfem/1DfemTransient_amesos.exe;
    ARGS = --verbose --method=BDF --echo-command-line;
    COMM = SERIAL;
}

# Vector 1DfemTransient with ImplicitBDF with AztecOO
(FRAMEWORK,INSTALL) {
    TESTS = ../example/epetra/1Dfem/1DfemTransient_aztecoo.exe;
    ARGS = --verbose --method=BDF --extra-linear-solver-params="<ParameterList><Parameter name=\"Linear Solver Type\" type=\"string\" value=\"AztecOO\"/><ParameterList name =\"Linear Solver Types\"><ParameterList name=\"AztecOO\"><ParameterList name=\"Forward Solve\"><Parameter name=\"Tolerance\" type=\"double\" value=\"1e-12\"/></ParameterList></ParameterList></ParameterList></ParameterList>" --linear-solver-params-used-file=lowsf.aztecoo.used.xml --echo-command-line;
    COMM = SERIAL,MPI;
}

# Vector 1DfemTransient with ImplicitBDF with Belos
(FRAMEWORK,INSTALL) {
    TESTS = ../example/epetra/1Dfem/1DfemTransient_belos.exe;
    ARGS = --verbose --method=BDF --extra-linear-solver-params="<ParameterList><Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Belos\"/><ParameterList name=\"Linear Solver Types\"><ParameterList name=\"Belos\"><Parameter name=\"Default Rel Res Norm\" type=\"double\" value=\"1e-12\"/></ParameterList></ParameterList></ParameterList>" --linear-solver-params-used-file=lowsf.belos.used.xml;
    COMM = SERIAL,MPI;
}


(FRAMEWORK,INSTALL,DIAGONAL,DIAGONAL0) {
    TESTS = ../example/diagonalTransient/diagonalTransient_amesos.exe;
    ARGS =
      --linear-solver-extra-params="
        <ParameterList>
          <ParameterList name=\"Stratimikos\">
            <Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Amesos\"/>
          </ParameterList>
          <ParameterList name=\"DiagonalTransientModel\">
            <Parameter name=\"NumElements\" type=\"int\" value=\"2\"/>
          </ParameterList>
          <ParameterList name=\"Rythmos Stepper\">
            <ParameterList name=\"VerboseObject\">
              <Parameter name=\"Verbosity Level\" type=\"string\" value=\"none\"/>
            </ParameterList>
          </ParameterList>
        </ParameterList>" \
      --final-time=1e-3 --num-time-steps=10 --verb-level=VERB_MEDIUM;
    COMM = SERIAL;
}


(FRAMEWORK,INSTALL,DIAGONAL,DIAGONAL1) {
    TESTS = ../example/diagonalTransient/diagonalTransient_amesos.exe;
    ARGS =
      --linear-solver-extra-params="
        <ParameterList>
          <ParameterList name=\"Stratimikos\">
            <Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Amesos\"/>
          </ParameterList>
          <ParameterList name=\"DiagonalTransientModel\">
            <Parameter name=\"NumElements\" type=\"int\" value=\"2\"/>
            <Parameter name=\"Coeff_s\" type=\"string\" value=\"\{ 31.4159 \}\"/>
          </ParameterList>
          <ParameterList name=\"Rythmos Stepper\">
            <ParameterList name=\"VerboseObject\">
              <Parameter name=\"Verbosity Level\" type=\"string\" value=\"none\"/>
            </ParameterList>
          </ParameterList>
        </ParameterList>" \
      --final-time=1e-3 --num-time-steps=10 --verb-level=VERB_MEDIUM;
    COMM = SERIAL;
}


(FRAMEWORK,INSTALL,DIAGONAL,DIAGONAL2) {
    TESTS = ../example/diagonalTransient/diagonalTransient_aztecoo.exe;
    ARGS =
      --linear-solver-extra-params="
        <ParameterList>
          <ParameterList name=\"TimeStepNonlinearSolver\">
            <Parameter name=\"Default Max Iters\" type=\"int\" value=\"3\"/>
            <Parameter name=\"Nonlinear Safety Factor\" type=\"double\" value=\"0.1\"/>
            <Parameter name=\"Linear Safety Factor\" type=\"double\" value=\"0.05\"/>
            <Parameter name=\"R Min Fraction\" type=\"double\" value=\"0.3\"/>
            <Parameter name=\"Thrown on Linear Solve Failure\" type=\"bool\" value=\"0\"/>
          </ParameterList>
          <ParameterList name=\"Stratimikos\">
            <Parameter name=\"Linear Solver Type\" type=\"string\" value=\"AztecOO\"/>
            <Parameter name=\"Preconditioner Type\" type=\"string\" value=\"None\"/>
            <ParameterList name=\"Linear Solver Types\">
              <ParameterList name=\"AztecOO\">
                <ParameterList name=\"Forward Solve\">
                  <Parameter name=\"Max Iterations\" type=\"int\" value=\"400\"/>
                  <Parameter name=\"Tolerance\" type=\"double\" value=\"1e-15\"/>
                  <ParameterList name=\"AztecOO Settings\">
                    <Parameter name=\"Output Frequency\" type=\"int\" value=\"1\"/>
                  </ParameterList>
                </ParameterList>
                <Parameter name=\"Output Every RHS\" type=\"bool\" value=\"1\"/>
                <ParameterList name=\"VerboseObject\">
                  <Parameter name=\"Verbosity Level\" type=\"string\" value=\"default\"/>
                </ParameterList>
              </ParameterList>
           </ParameterList>
         </ParameterList>
          <ParameterList name=\"DiagonalTransientModel\">
            <Parameter name=\"NumElements\" type=\"int\" value=\"2\"/>
            <Parameter name=\"Coeff_s\" type=\"string\" value=\"\{0.0\, 0.0\}\"/>
          </ParameterList>
          <ParameterList name=\"Rythmos Stepper\">
            <ParameterList name=\"VerboseObject\">
              <Parameter name=\"Verbosity Level\" type=\"string\" value=\"extreme\"/>
            </ParameterList>
          </ParameterList>
        </ParameterList>" \
      --final-time=1e-3 --num-time-steps=10 --verb-level=VERB_EXTREME;
    COMM = SERIAL;
}


(FRAMEWORK,INSTALL,DIAGONAL,DIAGONAL2b) {
    TESTS = ../example/diagonalTransient/diagonalTransient_belos.exe;
    ARGS =
      --linear-solver-extra-params="
        <ParameterList>
          <ParameterList name=\"TimeStepNonlinearSolver\">
            <Parameter name=\"Default Max Iters\" type=\"int\" value=\"3\"/>
            <Parameter name=\"Nonlinear Safety Factor\" type=\"double\" value=\"0.1\"/>
            <Parameter name=\"Linear Safety Factor\" type=\"double\" value=\"0.05\"/>
            <Parameter name=\"R Min Fraction\" type=\"double\" value=\"0.3\"/>
            <Parameter name=\"Thrown on Linear Solve Failure\" type=\"bool\" value=\"0\"/>
          </ParameterList>
          <ParameterList name=\"Stratimikos\">
            <Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Belos\"/>
            <Parameter name=\"Preconditioner Type\" type=\"string\" value=\"None\"/>
            <ParameterList name=\"Linear Solver Types\">
           </ParameterList>
         </ParameterList>
          <ParameterList name=\"DiagonalTransientModel\">
            <Parameter name=\"NumElements\" type=\"int\" value=\"2\"/>
            <Parameter name=\"Coeff_s\" type=\"string\" value=\"\{0.0\, 0.0\}\"/>
          </ParameterList>
          <ParameterList name=\"Rythmos Stepper\">
            <ParameterList name=\"VerboseObject\">
              <Parameter name=\"Verbosity Level\" type=\"string\" value=\"extreme\"/>
            </ParameterList>
          </ParameterList>
        </ParameterList>" \
      --final-time=1e-3 --num-time-steps=10 --verb-level=VERB_EXTREME;
    COMM = SERIAL;
}


(FRAMEWORK,INSTALL,DIAGONAL,DIAGONAL3) {
    TESTS = ../example/diagonalTransient/diagonalTransient_amesos.exe;
    ARGS =
      --linear-solver-extra-params="
        <ParameterList>
          <ParameterList name=\"TimeStepNonlinearSolver\">
            <Parameter name=\"Default Max Iters\" type=\"int\" value=\"3\"/>
            <Parameter name=\"Nonlinear Safety Factor\" type=\"double\" value=\"0.1\"/>
            <Parameter name=\"Linear Safety Factor\" type=\"double\" value=\"0.05\"/>
            <Parameter name=\"R Min Fraction\" type=\"double\" value=\"0.3\"/>
            <Parameter name=\"Thrown on Linear Solve Failure\" type=\"bool\" value=\"0\"/>
          </ParameterList>
          <ParameterList name=\"Stratimikos\">
            <Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Amesos\"/>
            <Parameter name=\"Preconditioner Type\" type=\"string\" value=\"None\"/>
          </ParameterList>
          <ParameterList name=\"DiagonalTransientModel\">
            <Parameter name=\"NumElements\" type=\"int\" value=\"16\"/>
            <Parameter name=\"Coeff_s\" type=\"string\" value=\"\{ 31.4159\,  30.0\, 15.0\, 5.0 \}\"/>
          </ParameterList>
          <ParameterList name=\"Rythmos Stepper\">
            <ParameterList name=\"VerboseObject\">
              <Parameter name=\"Verbosity Level\" type=\"string\" value=\"none\"/>
            </ParameterList>
          </ParameterList>
          <ParameterList name=\"FD Calc\">
            <Parameter name=\"FD Method\" type=\"string\" value=\"order-four-central\"/>
            <Parameter name=\"FD Step Length\" type=\"double\" value=\"1e+1\"/>
            <Parameter name=\"FD Step Select Type\" type=\"string\" value=\"Relative\"/>
          </ParameterList>
        </ParameterList>" \
      --final-time=1e-4 --num-time-steps=10 --verb-level=VERB_LOW \
      --echo-command-line \
      --fwd-sens-solve \
      --max-state-error=1e-6 \
      --max-sens-error=1e-6 \
      --dump-final-solutions;
    COMM = SERIAL;
}


(FRAMEWORK,INSTALL,DIAGONAL,DIAGONAL4) {
    TESTS = ../example/diagonalTransient/diagonalTransient_amesos.exe;
    ARGS =
      --linear-solver-extra-params="
        <ParameterList>
          <ParameterList name=\"TimeStepNonlinearSolver\">
            <Parameter name=\"Default Max Iters\" type=\"int\" value=\"3\"/>
            <Parameter name=\"Nonlinear Safety Factor\" type=\"double\" value=\"0.1\"/>
            <Parameter name=\"Linear Safety Factor\" type=\"double\" value=\"0.05\"/>
            <Parameter name=\"R Min Fraction\" type=\"double\" value=\"0.3\"/>
            <Parameter name=\"Thrown on Linear Solve Failure\" type=\"bool\" value=\"0\"/>
          </ParameterList>
          <ParameterList name=\"Stratimikos\">
            <Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Amesos\"/>
            <Parameter name=\"Preconditioner Type\" type=\"string\" value=\"None\"/>
          </ParameterList>
          <ParameterList name=\"DiagonalTransientModel\">
            <Parameter name=\"NumElements\" type=\"int\" value=\"1\"/>
            <Parameter name=\"Coeff_s\" type=\"string\" value=\"\{ 31.4159 \}\"/>
          </ParameterList>
          <ParameterList name=\"Rythmos Stepper\">
            <ParameterList name=\"VerboseObject\">
              <Parameter name=\"Verbosity Level\" type=\"string\" value=\"none\"/>
            </ParameterList>
          </ParameterList>
          <ParameterList name=\"FD Calc\">
            <Parameter name=\"FD Method\" type=\"string\" value=\"order-four-central\"/>
            <Parameter name=\"FD Step Length\" type=\"double\" value=\"1e+1\"/>
            <Parameter name=\"FD Step Select Type\" type=\"string\" value=\"Relative\"/>
          </ParameterList>
        </ParameterList>" \
      --final-time=1e-4 --num-time-steps=10 --verb-level=VERB_LOW \
      --echo-command-line \
      --fwd-sens-solve \
      --max-state-error=1e-6 \
      --max-sens-error=1e-6 \
      --dump-final-solutions;
    COMM = SERIAL;
}


(FRAMEWORK,INSTALL,DIAGONAL,DIAGONAL5) {
    TESTS = ../example/diagonalTransient/diagonalTransient_amesos.exe;
    ARGS =
      --linear-solver-extra-params="
        <ParameterList>
          <ParameterList name=\"TimeStepNonlinearSolver\">
            <Parameter name=\"Default Max Iters\" type=\"int\" value=\"3\"/>
            <Parameter name=\"Nonlinear Safety Factor\" type=\"double\" value=\"0.1\"/>
            <Parameter name=\"Linear Safety Factor\" type=\"double\" value=\"0.05\"/>
            <Parameter name=\"R Min Fraction\" type=\"double\" value=\"0.3\"/>
            <Parameter name=\"Thrown on Linear Solve Failure\" type=\"bool\" value=\"0\"/>
          </ParameterList>
          <ParameterList name=\"Stratimikos\">
            <Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Amesos\"/>
            <Parameter name=\"Preconditioner Type\" type=\"string\" value=\"None\"/>
          </ParameterList>
          <ParameterList name=\"DiagonalTransientModel\">
            <Parameter name=\"NumElements\" type=\"int\" value=\"5\"/>
            <Parameter name=\"Coeff_s\" type=\"string\" value=\"\{ 31.4159 \}\"/>
          </ParameterList>
          <ParameterList name=\"Rythmos Stepper\">
            <ParameterList name=\"VerboseObject\">
              <Parameter name=\"Verbosity Level\" type=\"string\" value=\"none\"/>
            </ParameterList>
          </ParameterList>
          <ParameterList name=\"FD Calc\">
            <Parameter name=\"FD Method\" type=\"string\" value=\"order-four-central\"/>
            <Parameter name=\"FD Step Length\" type=\"double\" value=\"1e+1\"/>
            <Parameter name=\"FD Step Select Type\" type=\"string\" value=\"Relative\"/>
          </ParameterList>
        </ParameterList>" \
      --final-time=1e-4 --num-time-steps=10 --verb-level=VERB_LOW \
      --echo-command-line \
      --fwd-sens-solve \
      --max-state-error=1e-6 \
      --max-sens-error=1e-6 \
      --dump-final-solutions;
    COMM = SERIAL;
}


# Solve state problem with fixed time steps using BDF stepper
(FRAMEWORK,INSTALL,DIAGONAL,DIAGONAL6) {
    TESTS = ../example/diagonalTransient/diagonalTransient_amesos.exe;
    ARGS =
      --linear-solver-extra-params="
        <ParameterList>
          <ParameterList name=\"TimeStepNonlinearSolver\">
            <Parameter name=\"Default Max Iters\" type=\"int\" value=\"3\"/>
            <Parameter name=\"Nonlinear Safety Factor\" type=\"double\" value=\"0.1\"/>
            <Parameter name=\"Linear Safety Factor\" type=\"double\" value=\"0.05\"/>
            <Parameter name=\"R Min Fraction\" type=\"double\" value=\"0.3\"/>
            <Parameter name=\"Thrown on Linear Solve Failure\" type=\"bool\" value=\"0\"/>
          </ParameterList>
          <ParameterList name=\"Stratimikos\">
            <Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Amesos\"/>
          </ParameterList>
          <ParameterList name=\"DiagonalTransientModel\">
            <Parameter name=\"NumElements\" type=\"int\" value=\"1\"/>
            <Parameter name=\"Coeff_s\" type=\"string\" value=\"\{ 31.4159 \}\"/>
          </ParameterList>
          <ParameterList name=\"Rythmos Stepper\">
            <ParameterList name=\"VerboseObject\">
              <Parameter name=\"Verbosity Level\" type=\"string\" value=\"low\"/>
            </ParameterList>
          </ParameterList>
        </ParameterList>" \
      --final-time=1e-3 --num-time-steps=10 --verb-level=VERB_EXTREME \
      --echo-command-line \
      --max-state-error=1e-6 \
      --dump-final-solutions \
      --use-BDF;
    COMM = SERIAL;
}


# Solve state problem with variable time steps using BDF stepper
(FRAMEWORK,INSTALL,DIAGONAL,DIAGONAL7) {
    TESTS = ../example/diagonalTransient/diagonalTransient_amesos.exe;
    ARGS =
      --linear-solver-extra-params="
        <ParameterList>
          <ParameterList name=\"TimeStepNonlinearSolver\">
            <Parameter name=\"Default Max Iters\" type=\"int\" value=\"3\"/>
            <Parameter name=\"Nonlinear Safety Factor\" type=\"double\" value=\"0.1\"/>
            <Parameter name=\"Linear Safety Factor\" type=\"double\" value=\"0.05\"/>
            <Parameter name=\"R Min Fraction\" type=\"double\" value=\"0.3\"/>
            <Parameter name=\"Thrown on Linear Solve Failure\" type=\"bool\" value=\"0\"/>
          </ParameterList>
          <ParameterList name=\"Stratimikos\">
            <Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Amesos\"/>
          </ParameterList>
          <ParameterList name=\"DiagonalTransientModel\">
            <Parameter name=\"NumElements\" type=\"int\" value=\"1\"/>
            <Parameter name=\"Coeff_s\" type=\"string\" value=\"\{ 31.4159 \}\"/>
          </ParameterList>
          <ParameterList name=\"Rythmos Stepper\">
            <ParameterList name=\"VerboseObject\">
              <Parameter name=\"Verbosity Level\" type=\"string\" value=\"low\"/>
            </ParameterList>
          </ParameterList>
        </ParameterList>" \
      --final-time=1e-4 --num-time-steps=-1 --verb-level=VERB_EXTREME \
      --echo-command-line \
      --max-state-error=1e-6 \
      --dump-final-solutions \
      --use-BDF;
    COMM = SERIAL;
}

# Test the computation of DxDp using the BDF stepper
# 2007/06/19: rabartl: Here I have set --max-restate-error=1e-8 to
# allow this check (which should be zero) to pass.  In this way, I am
# only really testing DxDp integrated vs. finite differences.
(FRAMEWORK,INSTALL,DIAGONAL,DIAGONAL8) {
    TESTS = ../example/diagonalTransient/diagonalTransient_amesos.exe;
    ARGS =
      --linear-solver-extra-params="
        <ParameterList>
          <ParameterList name=\"TimeStepNonlinearSolver\">
            <Parameter name=\"Default Max Iters\" type=\"int\" value=\"3\"/>
            <Parameter name=\"Nonlinear Safety Factor\" type=\"double\" value=\"0.1\"/>
            <Parameter name=\"Linear Safety Factor\" type=\"double\" value=\"0.05\"/>
            <Parameter name=\"R Min Fraction\" type=\"double\" value=\"0.3\"/>
            <Parameter name=\"Thrown on Linear Solve Failure\" type=\"bool\" value=\"0\"/>
          </ParameterList>
          <ParameterList name=\"Stratimikos\">
            <Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Amesos\"/>
          </ParameterList>
          <ParameterList name=\"DiagonalTransientModel\">
            <Parameter name=\"NumElements\" type=\"int\" value=\"1\"/>
            <Parameter name=\"Coeff_s\" type=\"string\" value=\"\{ 31.4159 \}\"/>
          </ParameterList>
          <ParameterList name=\"Rythmos Stepper\">
            <ParameterList name=\"VerboseObject\">
              <Parameter name=\"Verbosity Level\" type=\"string\" value=\"none\"/>
            </ParameterList>
          </ParameterList>
          <ParameterList name=\"FD Calc\">
            <Parameter name=\"FD Method\" type=\"string\" value=\"order-four-central\"/>
            <Parameter name=\"FD Step Length\" type=\"double\" value=\"1e+1\"/>
            <Parameter name=\"FD Step Select Type\" type=\"string\" value=\"Relative\"/>
          </ParameterList>
        </ParameterList>" \
      --final-time=1e-4 --num-time-steps=10 --verb-level=VERB_LOW \
      --echo-command-line \
      --fwd-sens-solve \
      --max-state-error=1e-6 \
      --max-restate-error=1e-8 \
      --max-sens-error=1e-6 \
      --dump-final-solutions \
      --use-BDF;
    COMM = SERIAL;
}


# 2007/06/14: rabartl: This tests the sensitivity computation for DxDp using
# the BDF time stepper and seems to work great for DxDp but the state
# recomputation is not the same binary number.  This must be some type of bug
# and this needs to be fixed.
(FRAMEWORK,INSTALL,DIAGONAL,DIAGONAL9,FAILING,FAILING1) {
    TESTS = ../example/diagonalTransient/diagonalTransient_amesos.exe;
    ARGS =
      --linear-solver-extra-params="
        <ParameterList>
          <ParameterList name=\"TimeStepNonlinearSolver\">
            <Parameter name=\"Default Max Iters\" type=\"int\" value=\"3\"/>
            <Parameter name=\"Nonlinear Safety Factor\" type=\"double\" value=\"0.1\"/>
            <Parameter name=\"Linear Safety Factor\" type=\"double\" value=\"0.05\"/>
            <Parameter name=\"R Min Fraction\" type=\"double\" value=\"0.3\"/>
            <Parameter name=\"Thrown on Linear Solve Failure\" type=\"bool\" value=\"0\"/>
          </ParameterList>
          <ParameterList name=\"Stratimikos\">
            <Parameter name=\"Linear Solver Type\" type=\"string\" value=\"Amesos\"/>
          </ParameterList>
          <ParameterList name=\"DiagonalTransientModel\">
            <Parameter name=\"NumElements\" type=\"int\" value=\"1\"/>
            <Parameter name=\"Coeff_s\" type=\"string\" value=\"\{ 31.4159 \}\"/>
          </ParameterList>
          <ParameterList name=\"Rythmos Stepper\">
            <ParameterList name=\"VerboseObject\">
              <Parameter name=\"Verbosity Level\" type=\"string\" value=\"none\"/>
            </ParameterList>
          </ParameterList>
          <ParameterList name=\"FD Calc\">
            <Parameter name=\"FD Method\" type=\"string\" value=\"order-four-central\"/>
            <Parameter name=\"FD Step Length\" type=\"double\" value=\"1e+1\"/>
            <Parameter name=\"FD Step Select Type\" type=\"string\" value=\"Relative\"/>
          </ParameterList>
        </ParameterList>" \
      --final-time=1e-4 --num-time-steps=10 --verb-level=VERB_LOW \
      --echo-command-line \
      --fwd-sens-solve \
      --max-state-error=1e-6 \
      --max-sens-error=1e-6 \
      --dump-final-solutions \
      --use-BDF;
    COMM = SERIAL;
}


# Explicit Taylor polynomial integration on Van der Pol oscillator
(FRAMEWORK,INSTALL) {
    TESTS = ExplicitTaylorPolynomialStepper/VanDerPolOscillator/vdp.exe;
    ARGS = --verbose;
    COMM = SERIAL;
    EXIT-STATUS = STRING-COMPARISON(Test passed!);
}
